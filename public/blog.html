<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>About Me | Crohn's Journal</title>
    <style>
      body {
        margin: 0;
        font-family: "Open Sans", sans-serif;
        background: linear-gradient(
          to bottom,
          #f4f4f4,
          #ffffff
        ); /* Light mode default */
        color: #111111;
        line-height: 1.6;
        transition: background-color 0.3s, color 0.3s;
        text-align: center;
      }

      .header {
        background-color: #0b0b1a;
        padding: 20px 40px;
        display: flex;
        justify-content: space-between;
        align-items: center;
        font-family: "Poppins", sans-serif;
        flex-wrap: wrap;
      }

      .logo {
        display: flex;
        align-items: center;
        text-decoration: none;
      }

      .logo-img {
        height: 45px;
        width: auto;
        display: block;
        cursor: pointer;
        transition: transform 0.2s ease-in-out;
      }

      .logo-img:hover {
        transform: scale(1.05);
      }

      .menu {
        list-style: none;
        display: flex;
        flex-wrap: wrap;
        gap: 20px;
        margin: 0;
        padding: 0;
        align-items: center;
      }

      .menu > li {
        display: flex;
        align-items: center;
        height: 100%;
        position: relative;
      }

      .menu li a,
      .advice-link {
        display: flex;
        align-items: center;
        height: 100%;
        color: #fff;
        text-decoration: none;
        font-weight: 500;
        font-size: 1rem;
        padding: 0 12px;
        box-sizing: border-box;
        line-height: 64px;
        transition: color 0.3s;
        position: relative;
      }

      .menu li a:hover,
      .advice-link:hover {
        color: #a855f7;
      }

      .menu li a:hover::after,
      .advice-link:hover::after {
        content: "";
        position: absolute;
        left: 0;
        bottom: 0;
        width: 100%;
        height: 2px;
        background-color: #a855f7;
      }

      .toggle-btn {
        background: none;
        border: none;
        cursor: pointer;
        height: 100%;
        display: flex;
        align-items: center;
      }

      .advice-dropdown {
        position: relative;
        display: flex;
        align-items: center;
        height: 100%;
      }

      .advice-link {
        padding: 0 12px;
        background: none;
        border: none;
        font: inherit;
        height: 100%;
        line-height: 64px;
        color: #fff;
        text-decoration: none;
        font-weight: 500;
        font-size: 1rem;
        transition: color 0.3s;
      }

      .advice-caret {
        margin-left: 4px;
        font-size: 0.8em;
      }

      .dropdown-menu {
        display: none;
        position: absolute;
        top: 100%;
        left: 0;
        background: #0b0b1a;
        color: #fff;
        min-width: 160px;
        box-shadow: 0 8px 16px rgba(0, 0, 0, 0.2);
        border-radius: 4px;
        padding: 10px 0;
        z-index: 1000;
      }

      .dropdown-item {
        color: #fff;
        text-decoration: none;
        padding: 10px 20px;
        display: block;
        transition: background-color 0.3s;
        text-align: left;
        font-size: 1rem;
        font-weight: 500;
        background: none;
        border: none;
      }

      .dropdown-item:hover {
        background-color: #a855f7;
        color: #fff;
      }

      .toggle-switch {
        position: relative;
        display: inline-block;
        width: 52px;
        height: 28px;
      }

      .toggle-switch input {
        opacity: 0;
        width: 0;
        height: 0;
      }

      .slider {
        position: absolute;
        cursor: pointer;
        background-color: #d1d1d1;
        border-radius: 34px;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        transition: background-color 0.4s;
      }

      .slider:before {
        content: "‚òÄÔ∏è";
        position: absolute;
        height: 24px;
        width: 24px;
        left: 2px;
        bottom: 2px;
        background-color: white;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 14px;
        transition: transform 0.4s, content 0.4s;
      }

      input:checked + .slider {
        background-color: #87b3ff;
      }

      input:checked + .slider:before {
        transform: translateX(24px);
        content: "üåú";
      }

      .content {
        padding: 60px 20px;
        max-width: 700px;
        margin: 0 auto;
      }

      #controls {
        padding: 1em 2em;
        display: flex;
        flex-wrap: wrap;
        gap: 1em;
        align-items: center;
      }

      #tag-filter,
      #search-bar {
        flex: 1;
      }

      #search-input {
        width: 100%;
        padding: 0.5em;
        font-size: 1rem;
      }

      .filter-btn {
        padding: 6px 14px;
        font-size: 0.9rem;
        border: none;
        border-radius: 8px;
        background: #ddd;
        cursor: pointer;
      }

      .filter-btn.active,
      .filter-btn:hover {
        background: #a855f7;
        color: white;
      }

      .dark-mode .filter-btn {
        background: #333;
        color: #eee;
      }

      .dark-mode .filter-btn.active,
      .dark-mode .filter-btn:hover {
        background: #a855f7;
        color: white;
      }

      .blog-container {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
        gap: 1.5em;
        padding: 2em;
      }

      .blog-card {
        background: #fff;
        color: #111;
        border-radius: 12px;
        padding: 20px;
        box-shadow: 0 4px 16px rgba(0, 0, 0, 0.1);
        transition: transform 0.3s ease, box-shadow 0.3s ease;
      }

      .blog-card:hover {
        transform: translateY(-5px);
        box-shadow: 0 8px 20px rgba(0, 0, 0, 0.15);
      }

      .dark-mode .blog-card {
        background-color: #1e1e2f;
        color: white;
      }

      .tag {
        display: inline-block;
        background: #a855f7;
        color: white;
        font-size: 0.75rem;
        padding: 4px 10px;
        margin: 4px 4px 0 0;
        border-radius: 12px;
      }

      .modal {
        position: fixed;
        z-index: 2000;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        overflow-y: auto;
        background: rgba(0, 0, 0, 0.7);
        display: none;
        justify-content: center;
        align-items: flex-start;
        padding-top: 60px;
      }

      .modal.show {
        display: flex;
        animation: fadeIn 0.3s ease;
      }

      .modal-content {
        background: white;
        color: black;
        width: 90%;
        max-width: 800px;
        padding: 30px;
        border-radius: 10px;
        position: relative;
        animation: slideDown 0.3s ease;
      }

      .modal-content.fullscreen {
        width: 95vw;
        height: 95vh;
        max-width: none;
        max-height: none;
        border-radius: 0;
        padding: 40px;
        overflow-y: auto;
      }

      .dark-mode .modal-content,
      .dark-mode .modal-content.fullscreen {
        background: #111;
        color: white;
      }

      .close-btn,
      .fullscreen-btn {
        position: absolute;
        top: 12px;
        font-size: 20px;
        cursor: pointer;
        background: none;
        border: none;
      }

      .close-btn {
        right: 20px;
      }

      .fullscreen-btn {
        right: 60px;
      }

      footer {
        background: #0b0b19;
        color: white;
        text-align: center;
        padding: 1em;
      }

      @keyframes fadeIn {
        from {
          opacity: 0;
        }
        to {
          opacity: 1;
        }
      }

      @keyframes slideDown {
        from {
          transform: translateY(-30px);
          opacity: 0;
        }
        to {
          transform: translateY(0);
          opacity: 1;
        }
      }
      @media (max-width: 768px) {
        .dropdown-menu {
          position: static;
          box-shadow: none;
          background: none;
          padding-left: 12px;
        }

        .dropdown-item {
          padding: 8px 0;
          background-color: transparent;
          color: #fff;
        }
      }
    </style>
  </head>
  <body>
    <div class="header">
      <a href="/" class="logo">
        <img
          src="3cebaa3d-b12b-4716-9b8b-5ed782aba4b6.png"
          alt="Crohn's Journal logo"
          class="logo-img"
        />
      </a>
      <nav>
        <ul class="menu">
          <li><a href="/">Home</a></li>
          <li><a href="/about.html">About Me</a></li>
          <li class="advice-dropdown">
            <a
              href="#"
              class="advice-link"
              onclick="toggleAdviceDropdown(event)"
              >Advice ‚ñº</a
            >
            <ul class="dropdown-menu" id="advice-dropdown-menu">
              <li><a href="/food.html" class="dropdown-item">Food</a></li>
              <li><a href="/school.html" class="dropdown-item">School</a></li>
            </ul>
          </li>
          <li><a href="/blog.html" class="active">Blog</a></li>
          <li><a href="/contact.html">Contact Me</a></li>
          <li>
            <label class="toggle-switch">
              <input type="checkbox" id="theme-toggle" />
              <span class="slider"></span>
            </label>
          </li>
        </ul>
      </nav>
    </div>

    <div id="controls">
      <div id="tag-filter"></div>
      <div id="search-bar">
        <input type="text" id="search-input" placeholder="Search by title..." />
      </div>
    </div>

    <main class="blog-container" id="blog-container"></main>

    <div id="blog-modal" class="modal" tabindex="-1">
      <div class="modal-content" role="dialog" aria-modal="true">
        <button class="fullscreen-btn" aria-label="Toggle fullscreen">üóñ</button>
        <button class="close-btn" aria-label="Close modal">&times;</button>
        <div id="modal-body"></div>
      </div>
    </div>

    <footer>
      <p>&copy; by siva</p>
    </footer>
    <script>
      const toggle = document.getElementById("theme-toggle");
      const modal = document.getElementById("blog-modal");
      const modalBody = document.getElementById("modal-body");
      const closeBtn = document.querySelector(".close-btn");
      const fullscreenBtn = document.querySelector(".fullscreen-btn");
      const tagFilter = document.getElementById("tag-filter");
      const searchInput = document.getElementById("search-input");
      let allPosts = [];
      let currentIndex = -1;
      let activeTags = new Set();

      // Set theme
      function setThemeFromStorage() {
        const isDark = localStorage.getItem("darkMode") === "true";
        document.body.classList.toggle("dark-mode", isDark);
        toggle.checked = isDark;
      }

      setThemeFromStorage();

      toggle.addEventListener("change", () => {
        const isDark = toggle.checked;
        document.body.classList.toggle("dark-mode", isDark);
        localStorage.setItem("darkMode", isDark);
      });

      function toggleAdviceDropdown(e) {
        e.preventDefault();
        const menu = document.getElementById("advice-dropdown-menu");
        menu.style.display = menu.style.display === "block" ? "none" : "block";
      }

      document.addEventListener("click", e => {
        const menu = document.getElementById("advice-dropdown-menu");
        if (!e.target.closest(".advice-dropdown")) {
          menu && (menu.style.display = "none");
        }
      });

      // Render blog cards
      function renderCards(posts) {
        const container = document.getElementById("blog-container");
        container.innerHTML = "";

        posts.forEach((post, index) => {
          const card = document.createElement("section");
          card.className = "blog-card";
          card.dataset.tags = (post.tags || []).join(",");
          card.dataset.title = post.title.toLowerCase();

          const tagsHTML = (post.tags || [])
            .map(tag => `<span class="tag">${tag}</span>`)
            .join("");

          card.innerHTML = `
        <h2>${post.title}</h2>
        <p>${(post.intro || post.introduction || "").slice(0, 100)}...</p>
        <div class="tags">${tagsHTML}</div>
      `;

          card.addEventListener("click", () => openModal(index));
          container.appendChild(card);
        });
      }

      // Filter by tags + search input
      function filterCards() {
        const searchTerm = searchInput.value.toLowerCase();
        document.querySelectorAll(".blog-card").forEach(card => {
          const cardTitle = card.dataset.title;
          const cardTags = card.dataset.tags.split(",");
          const matchesSearch = cardTitle.includes(searchTerm);
          const matchesTags =
            activeTags.size === 0 ||
            [...activeTags].every(tag => cardTags.includes(tag));
          card.style.display = matchesSearch && matchesTags ? "block" : "none";
        });
      }

      fetch("blogData.json")
        .then(res => res.json())
        .then(posts => {
          allPosts = posts;
          renderCards(posts);

          // Create tag buttons
          const allTags = new Set();
          posts.forEach(post =>
            (post.tags || []).forEach(tag => allTags.add(tag))
          );

          tagFilter.innerHTML = [...allTags]
            .map(
              tag =>
                `<button class="filter-btn" data-tag="${tag}">${tag}</button>`
            )
            .join("");

          document.querySelectorAll(".filter-btn").forEach(btn => {
            btn.addEventListener("click", () => {
              const tag = btn.dataset.tag;
              if (activeTags.has(tag)) {
                activeTags.delete(tag);
                btn.classList.remove("active");
              } else {
                activeTags.add(tag);
                btn.classList.add("active");
              }
              filterCards();
            });
          });

          searchInput.addEventListener("input", filterCards);
        });

      // Modal logic
      function openModal(index) {
        currentIndex = index;
        const post = allPosts[index];
        let html = `<h2>${post.title}</h2>`;
        if (post.introduction || post.intro)
          html += `<p>${post.introduction || post.intro}</p>`;
        if (post.recipe)
          html += `<p><strong>Recipe:</strong> ${post.recipe}</p>`;
        if (post.why_section)
          html += `<h4>Why This Recipe Works:</h4><ul>${post.why_section
            .map(i => `<li>${i}</li>`)
            .join("")}</ul>`;
        if (post.customize)
          html += `<h4>Customizations:</h4><ul>${post.customize
            .map(i => `<li>${i}</li>`)
            .join("")}</ul>`;
        if (post.conclusion)
          html += `<p><strong>Conclusion:</strong> ${post.conclusion}</p>`;
        modalBody.innerHTML = html;
        modal.classList.add("show");
        document.body.style.overflow = "hidden";
        modal.focus();
      }

      function closeModal() {
        modal.classList.remove("show");
        modal.querySelector(".modal-content").classList.remove("fullscreen");
        fullscreenBtn.textContent = "üóñ";
        modalBody.innerHTML = "";
        document.body.style.overflow = "";
      }

      closeBtn.addEventListener("click", closeModal);

      fullscreenBtn.addEventListener("click", () => {
        const modalContent = modal.querySelector(".modal-content");
        const isFullscreen = modalContent.classList.toggle("fullscreen");
        fullscreenBtn.textContent = isFullscreen ? "üóó" : "üóñ";
      });

      window.addEventListener("click", e => {
        if (e.target === modal) closeModal();
      });

      window.addEventListener("keydown", e => {
        if (!modal.classList.contains("show")) return;
        if (e.key === "Escape") closeModal();
        if (e.key === "ArrowLeft" && currentIndex > 0)
          openModal(currentIndex - 1);
        if (e.key === "ArrowRight" && currentIndex < allPosts.length - 1)
          openModal(currentIndex + 1);
        if (e.key === "Tab") trapFocus(e);
      });

      function trapFocus(e) {
        const focusable = modal.querySelectorAll(
          "button, [href], input, select, textarea, [tabindex]:not([tabindex='-1'])"
        );
        const first = focusable[0];
        const last = focusable[focusable.length - 1];
        if (e.shiftKey && document.activeElement === first) {
          e.preventDefault();
          last.focus();
        } else if (!e.shiftKey && document.activeElement === last) {
          e.preventDefault();
          first.focus();
        }
      }
    </script>
  </body>
</html>
